<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="styles/style.css" />
		<title>Weather Forecast</title>
	</head>
	<body>
		<div class="main-top">
			<div class="left">
				<p class="temperature" id="temperature"></p>
				<p class="temperatur-feels-like" id="temperatur-feels-like"></p>
				<p class="weather-description" id="weather-description"></p>
				<p class="humidity" id="humidity"></p>
				<p class="cloudy" id="cloudy"></p>
				<p class="uv" id="uv"></p>
			</div>
			<div class="right">
				<h1 class="city" id="city"></h1>
				<p class="last-update" id="last-update">
					<svg
						stroke="currentColor"
						fill="currentColor"
						stroke-width="0"
						viewBox="0 0 24 24"
						height="1em"
						width="1em"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							fill="none"
							stroke="#000"
							stroke-width="2"
							d="M1.7507,16.0022 C3.3517,20.0982 7.3367,23.0002 11.9997,23.0002 C18.0747,23.0002 22.9997,18.0752 22.9997,12.0002 M22.2497,7.9982 C20.6487,3.9012 16.6627,1.0002 11.9997,1.0002 C5.9247,1.0002 0.9997,5.9252 0.9997,12.0002 M8.9997,16.0002 L0.9997,16.0002 L0.9997,24.0002 M22.9997,0.0002 L22.9997,8.0002 L14.9997,8.0002"
						></path>
					</svg>
				</p>
				<p class="sunrise" id="sunrise">
					<svg
						stroke="currentColor"
						fill="none"
						stroke-width="2"
						viewBox="0 0 24 24"
						stroke-linecap="round"
						stroke-linejoin="round"
						height="1em"
						width="1em"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path d="M17 18a5 5 0 0 0-10 0"></path>
						<line x1="12" y1="2" x2="12" y2="9"></line>
						<line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line>
						<line x1="1" y1="18" x2="3" y2="18"></line>
						<line x1="21" y1="18" x2="23" y2="18"></line>
						<line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line>
						<line x1="23" y1="22" x2="1" y2="22"></line>
						<polyline points="8 6 12 2 16 6"></polyline>
					</svg>
				</p>
				<p class="sunset" id="sunset">
					<svg
						stroke="currentColor"
						fill="none"
						stroke-width="2"
						viewBox="0 0 24 24"
						stroke-linecap="round"
						stroke-linejoin="round"
						height="1em"
						width="1em"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path d="M17 18a5 5 0 0 0-10 0"></path>
						<line x1="12" y1="9" x2="12" y2="2"></line>
						<line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line>
						<line x1="1" y1="18" x2="3" y2="18"></line>
						<line x1="21" y1="18" x2="23" y2="18"></line>
						<line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line>
						<line x1="23" y1="22" x2="1" y2="22"></line>
						<polyline points="16 5 12 9 8 5"></polyline>
					</svg>
				</p>
			</div>
		</div>
		<script>
			async function fetchCurrentWeather() {
				let response = await fetch('http://127.0.0.1:8000/current_weather');

				console.log(response.status, response.statusText); // 200 OK

				if (response.status === 200) {
					var data = await response.text();
					// handle data
					// convert var data to json object
					data = JSON.parse(data);
					console.log(data);
					document.getElementById('city').textContent = data.city;
					document.getElementById('temperature').textContent =
						'Temperatur: ' + data.temperature + '°C';
					document.getElementById('temperatur-feels-like').textContent =
						'Gefühlt: ' + data.temperatur_feels_like + '°C';
					document.getElementById('weather-description').textContent =
						data.weather_description;
					document.getElementById('humidity').textContent =
						'Luftfeuchtigkeit: ' + data.humidity + '%';
					document.getElementById('cloudy').textContent =
						'Wolken: ' + data.cloudy + '%';
					document.getElementById('last-update').textContent =
						' ' + data.last_update;
					document.getElementById('sunrise').textContent = ' ' + data.sunrise;
					document.getElementById('sunset').textContent = ' ' + data.sunset;

					var img = document.createElement('img');
					img.src =
						'C:/Users/Ludo/Desktop/weather forecast/resources/sun icons/sync.png';
					var div = document.getElementById('last-update');
					div.prepend(img);
					img.style.height = '20px';
					img.style.width = 'auto';

					var img = document.createElement('img');
					img.src =
						'C:/Users/Ludo/Desktop/weather forecast/resources/sun icons/Ebene 2.png';
					var div = document.getElementById('sunrise');
					div.prepend(img);
					img.style.height = 'auto';
					img.style.width = '24px';

					var img = document.createElement('img');
					img.src =
						'C:/Users/Ludo/Desktop/weather forecast/resources/sun icons/Ebene 1.png';
					var div = document.getElementById('sunset');
					div.prepend(img);
					img.style.height = 'auto';
					img.style.width = '24px';
				}
			}
			async function fetchUv() {
				let response = await fetch('http://127.0.0.1:8000/additional_weather');

				console.log(response.status, response.statusText); // 200 OK

				if (response.status === 200) {
					var data = await response.text();
					// handle data
					// convert var data to json object
					data = JSON.parse(data);
					console.log(data);
					document.getElementById('uv').textContent = 'UV Index: ' + data.uv;
				}
			}
			fetchCurrentWeather();
			fetchUv();
		</script>

		<div class="main-bottom">
			<div class="day one">
				<h1 class="day-pred" id="day_pred_1"></h1>
				<p class="date" id="date_1"></p>
				<img id="icon_1" src="" alt="" />
				<p class="temp-min" id="temp_min_1"></p>
				<p class="temp-max" id="temp_max_1"></p>
			</div>
			<div class="day two">
				<h1 class="day-pred" id="day_pred_2"></h1>
				<p class="date" id="date_2"></p>
				<img id="icon_2" src="" alt="" />
				<p class="temp-min" id="temp_min_2"></p>
				<p class="temp-max" id="temp_max_2"></p>
			</div>
			<div class="day three">
				<h1 class="day-pred" id="day_pred_3"></h1>
				<p class="date" id="date_3"></p>
				<img id="icon_3" src="" alt="" />
				<p class="temp-min" id="temp_min_3"></p>
				<p class="temp-max" id="temp_max_3"></p>
			</div>
			<div class="day four">
				<h1 class="day-pred">Tag 4</h1>
				<p class="date">1.1.22</p>
				<p class="icon">Icon</p>
				<p class="temp-min">TempMin</p>
				<p class="temp-max">TempMax</p>
			</div>
			<div class="day five">
				<h1 class="day-pred">Tag 5</h1>
				<p class="date">1.1.22</p>
				<p class="icon">Icon</p>
				<p class="temp-min">TempMin</p>
				<p class="temp-max">TempMax</p>
			</div>
		</div>
		<script>
			async function fetchForecastWeatherWeek() {
				let response = await fetch(
					'http://127.0.0.1:8000/forecast_weather_week'
				);

				console.log(response.status, response.statusText); // 200 OK

				if (response.status === 200) {
					var data = await response.text();
					// handle data
					// convert var data to json object
					data = JSON.parse(data);
					console.log(data);
					document.getElementById('day_pred_1').textContent = data.day1.day;
					document.getElementById('date_1').textContent = data.day1.date;
					document.getElementById('icon_1').src = data.day1.icon;
					document.getElementById('temp_min_1').textContent =
						data.day1.temp_min;
					document.getElementById('temp_max_1').textContent =
						data.day1.temp_max;

					document.getElementById('day_pred_2').textContent = data.day2.day;
					document.getElementById('date_2').textContent = data.day2.date;
					document.getElementById('icon_2').src = data.day2.icon;
					document.getElementById('temp_min_2').textContent =
						data.day2.temp_min;
					document.getElementById('temp_max_2').textContent =
						data.day2.temp_max;

					document.getElementById('day_pred_3').textContent = data.day3.day;
					document.getElementById('date_3').textContent = data.day3.date;
					document.getElementById('icon_3').src = data.day3.icon;
					document.getElementById('temp_min_3').textContent =
						data.day3.temp_min;
					document.getElementById('temp_max_3').textContent =
						data.day3.temp_max;
				}
			}
			fetchForecastWeatherWeek();
		</script>
		<div class="bottom"></div>
		<script>
			// Call a function every 600000 milliseconds (10min)
			window.setInterval('refresh()', 600000);
			// Refresh or reload page.
			function refresh() {
				window.location.reload();
			}
		</script>
	</body>
</html>
